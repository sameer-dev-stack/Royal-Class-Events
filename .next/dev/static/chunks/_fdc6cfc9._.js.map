{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Meskat/Documents/Royal-Class-Events-main/hooks/use-seat-hotkeys.js"],"sourcesContent":["\"use client\";\r\n\r\nimport { useEffect } from \"react\";\r\nimport useSeatEngine, { TOOL_TYPES } from \"./use-seat-engine\";\r\n\r\n/**\r\n * Royal Seat Engine - Hotkeys Hook\r\n * Centralizes all keyboard shortcuts for the builder.\r\n */\r\nexport default function useSeatHotkeys() {\r\n    const {\r\n        setTool,\r\n        clearSelection,\r\n        deleteSelectedElement,\r\n        copySelection,\r\n        pasteSelection,\r\n        nudgeElements,\r\n        selectedIds\r\n    } = useSeatEngine();\r\n\r\n    useEffect(() => {\r\n        const handleKeyDown = (e) => {\r\n            // Skip if user is typing in an input\r\n            if (e.target.tagName === \"INPUT\" || e.target.tagName === \"TEXTAREA\" || e.target.tagName === \"SELECT\") return;\r\n\r\n            const key = e.key.toUpperCase();\r\n            const ctrl = e.ctrlKey || e.metaKey;\r\n            const shift = e.shiftKey;\r\n\r\n            // 1. Deletion\r\n            if (e.key === \"Delete\" || e.key === \"Backspace\") {\r\n                deleteSelectedElement();\r\n                return;\r\n            }\r\n\r\n            // 2. Clipboard Operations\r\n            if (ctrl && key === \"C\") {\r\n                copySelection();\r\n                e.preventDefault();\r\n                return;\r\n            }\r\n            if (ctrl && key === \"V\") {\r\n                pasteSelection();\r\n                e.preventDefault();\r\n                return;\r\n            }\r\n\r\n            // 3. Nudging\r\n            const nudgeStep = shift ? 10 : 2;\r\n            if (e.key === \"ArrowLeft\") {\r\n                nudgeElements(-nudgeStep, 0);\r\n                e.preventDefault();\r\n            } else if (e.key === \"ArrowRight\") {\r\n                nudgeElements(nudgeStep, 0);\r\n                e.preventDefault();\r\n            } else if (e.key === \"ArrowUp\") {\r\n                nudgeElements(0, -nudgeStep);\r\n                e.preventDefault();\r\n            } else if (e.key === \"ArrowDown\") {\r\n                nudgeElements(0, nudgeStep);\r\n                e.preventDefault();\r\n            }\r\n\r\n            // 4. Tool Hotkeys\r\n            const toolMap = {\r\n                \"V\": TOOL_TYPES.SELECT,\r\n                \"R\": TOOL_TYPES.RECTANGLE,\r\n                \"C\": TOOL_TYPES.CIRCLE,\r\n                \"P\": TOOL_TYPES.POLYGON,\r\n                \"A\": TOOL_TYPES.CURVE,\r\n                \"I\": TOOL_TYPES.IMAGE\r\n            };\r\n\r\n            if (!ctrl && toolMap[key]) {\r\n                setTool(toolMap[key]);\r\n                clearSelection();\r\n            }\r\n        };\r\n\r\n        window.addEventListener(\"keydown\", handleKeyDown);\r\n        return () => window.removeEventListener(\"keydown\", handleKeyDown);\r\n    }, [\r\n        setTool, clearSelection, deleteSelectedElement,\r\n        copySelection, pasteSelection, nudgeElements, selectedIds\r\n    ]);\r\n}\r\n"],"names":[],"mappings":";;;;AAEA;AACA;;AAHA;;;AASe,SAAS;;IACpB,MAAM,EACF,OAAO,EACP,cAAc,EACd,qBAAqB,EACrB,aAAa,EACb,cAAc,EACd,aAAa,EACb,WAAW,EACd,GAAG,IAAA,4IAAa;IAEjB,IAAA,0KAAS;oCAAC;YACN,MAAM;0DAAgB,CAAC;oBACnB,qCAAqC;oBACrC,IAAI,EAAE,MAAM,CAAC,OAAO,KAAK,WAAW,EAAE,MAAM,CAAC,OAAO,KAAK,cAAc,EAAE,MAAM,CAAC,OAAO,KAAK,UAAU;oBAEtG,MAAM,MAAM,EAAE,GAAG,CAAC,WAAW;oBAC7B,MAAM,OAAO,EAAE,OAAO,IAAI,EAAE,OAAO;oBACnC,MAAM,QAAQ,EAAE,QAAQ;oBAExB,cAAc;oBACd,IAAI,EAAE,GAAG,KAAK,YAAY,EAAE,GAAG,KAAK,aAAa;wBAC7C;wBACA;oBACJ;oBAEA,0BAA0B;oBAC1B,IAAI,QAAQ,QAAQ,KAAK;wBACrB;wBACA,EAAE,cAAc;wBAChB;oBACJ;oBACA,IAAI,QAAQ,QAAQ,KAAK;wBACrB;wBACA,EAAE,cAAc;wBAChB;oBACJ;oBAEA,aAAa;oBACb,MAAM,YAAY,QAAQ,KAAK;oBAC/B,IAAI,EAAE,GAAG,KAAK,aAAa;wBACvB,cAAc,CAAC,WAAW;wBAC1B,EAAE,cAAc;oBACpB,OAAO,IAAI,EAAE,GAAG,KAAK,cAAc;wBAC/B,cAAc,WAAW;wBACzB,EAAE,cAAc;oBACpB,OAAO,IAAI,EAAE,GAAG,KAAK,WAAW;wBAC5B,cAAc,GAAG,CAAC;wBAClB,EAAE,cAAc;oBACpB,OAAO,IAAI,EAAE,GAAG,KAAK,aAAa;wBAC9B,cAAc,GAAG;wBACjB,EAAE,cAAc;oBACpB;oBAEA,kBAAkB;oBAClB,MAAM,UAAU;wBACZ,KAAK,+IAAU,CAAC,MAAM;wBACtB,KAAK,+IAAU,CAAC,SAAS;wBACzB,KAAK,+IAAU,CAAC,MAAM;wBACtB,KAAK,+IAAU,CAAC,OAAO;wBACvB,KAAK,+IAAU,CAAC,KAAK;wBACrB,KAAK,+IAAU,CAAC,KAAK;oBACzB;oBAEA,IAAI,CAAC,QAAQ,OAAO,CAAC,IAAI,EAAE;wBACvB,QAAQ,OAAO,CAAC,IAAI;wBACpB;oBACJ;gBACJ;;YAEA,OAAO,gBAAgB,CAAC,WAAW;YACnC;4CAAO,IAAM,OAAO,mBAAmB,CAAC,WAAW;;QACvD;mCAAG;QACC;QAAS;QAAgB;QACzB;QAAe;QAAgB;QAAe;KACjD;AACL;GA5EwB;;QAShB,4IAAa"}},
    {"offset": {"line": 99, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Meskat/Documents/Royal-Class-Events-main/utils/geometry.js"],"sourcesContent":["/**\r\n * Royal Seat Engine - Geometry Utilities\r\n * Phase 11: Curved Layouts\r\n */\r\n\r\n/**\r\n * Calculates X/Y position for a point on an arc\r\n * @param {number} centerX \r\n * @param {number} centerY \r\n * @param {number} radius \r\n * @param {number} angleInDegrees \r\n */\r\nexport const calculateArcPosition = (centerX, centerY, radius, angleInDegrees) => {\r\n    const angleInRadians = (angleInDegrees - 90) * (Math.PI / 180); // Adjusted to start from top\r\n    return {\r\n        x: centerX + radius * Math.cos(angleInRadians),\r\n        y: centerY + radius * Math.sin(angleInRadians),\r\n    };\r\n};\r\n\r\n/**\r\n * Generates seat positions for a curved row\r\n * @param {Object} config \r\n */\r\nexport const generateArcSeats = ({\r\n    centerX,\r\n    centerY,\r\n    radius,\r\n    startAngle, // e.g., -45\r\n    endAngle,   // e.g., 45\r\n    seatCount,\r\n    spacing = 1\r\n}) => {\r\n    const seats = [];\r\n    if (seatCount <= 0) return seats;\r\n\r\n    // Angle step\r\n    const totalAngle = endAngle - startAngle;\r\n    const step = seatCount > 1 ? totalAngle / (seatCount - 1) : 0;\r\n\r\n    for (let i = 0; i < seatCount; i++) {\r\n        const angle = startAngle + (step * i);\r\n        const pos = calculateArcPosition(centerX, centerY, radius, angle);\r\n        seats.push({\r\n            ...pos,\r\n            angle,\r\n            id: `seat-${i}`\r\n        });\r\n    }\r\n\r\n    return seats;\r\n};\r\n"],"names":[],"mappings":"AAAA;;;CAGC,GAED;;;;;;CAMC;;;;;;AACM,MAAM,uBAAuB,CAAC,SAAS,SAAS,QAAQ;IAC3D,MAAM,iBAAiB,CAAC,iBAAiB,EAAE,IAAI,CAAC,KAAK,EAAE,GAAG,GAAG,GAAG,6BAA6B;IAC7F,OAAO;QACH,GAAG,UAAU,SAAS,KAAK,GAAG,CAAC;QAC/B,GAAG,UAAU,SAAS,KAAK,GAAG,CAAC;IACnC;AACJ;AAMO,MAAM,mBAAmB,CAAC,EAC7B,OAAO,EACP,OAAO,EACP,MAAM,EACN,UAAU,EACV,QAAQ,EACR,SAAS,EACT,UAAU,CAAC,EACd;IACG,MAAM,QAAQ,EAAE;IAChB,IAAI,aAAa,GAAG,OAAO;IAE3B,aAAa;IACb,MAAM,aAAa,WAAW;IAC9B,MAAM,OAAO,YAAY,IAAI,aAAa,CAAC,YAAY,CAAC,IAAI;IAE5D,IAAK,IAAI,IAAI,GAAG,IAAI,WAAW,IAAK;QAChC,MAAM,QAAQ,aAAc,OAAO;QACnC,MAAM,MAAM,qBAAqB,SAAS,SAAS,QAAQ;QAC3D,MAAM,IAAI,CAAC;YACP,GAAG,GAAG;YACN;YACA,IAAI,CAAC,KAAK,EAAE,GAAG;QACnB;IACJ;IAEA,OAAO;AACX"}},
    {"offset": {"line": 145, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Meskat/Documents/Royal-Class-Events-main/components/seat-engine/CanvasStage.jsx"],"sourcesContent":["\"use client\";\r\n\r\nimport React, { useRef, useEffect, useCallback, useState } from \"react\";\r\nimport { Stage, Layer, Rect, Circle, Group, Transformer, Text, Line, Image as KonvaImage } from \"react-konva\";\r\nimport useSeatEngine, { TOOL_TYPES, SEAT_NAMING } from \"@/hooks/use-seat-engine\";\r\nimport useSeatHotkeys from \"@/hooks/use-seat-hotkeys\";\r\nimport { calculateArcPosition } from \"@/utils/geometry\";\r\n\r\n/**\r\n * Royal Seat Engine - Canvas Stage Component\r\n * Phase 11: Curves, LOD & Assets\r\n */\r\n\r\n// Scale constraints\r\nconst MIN_SCALE = 0.05;\r\nconst MAX_SCALE = 5;\r\nconst SCALE_FACTOR = 1.1;\r\n\r\n// Colors\r\nconst ZONE_FILL_DEFAULT = \"#D4AF37\";\r\nconst ZONE_OPACITY = 0.15;\r\nconst LOD_OPACITY = 0.8; // High opacity for zoomed out blocks\r\nconst SEAT_FILL_DEFAULT = \"#52525b\"; // Fallback zinc\r\nconst GHOST_OPACITY = 0.5;\r\nconst SNAP_RADIUS = 15;\r\n\r\n// Zone padding\r\nconst ZONE_PADDING = 10;\r\nconst TITLE_HEIGHT = 20;\r\nconst LABEL_WIDTH = 25;\r\n\r\n// LOD Threshold\r\nconst LOD_THRESHOLD = 0.4;\r\n\r\n/**\r\n * Helper to generate row label text\r\n */\r\nfunction getRowLabel(index, namingType) {\r\n    if (namingType === SEAT_NAMING.NUMERICAL) return (index + 1).toString();\r\n    const letters = \"ABCDEFGHIJKLMNOPQRSTUVWXYZ\";\r\n    if (index < 26) return letters[index];\r\n    const first = Math.floor(index / 26) - 1;\r\n    const second = index % 26;\r\n    return letters[first] + letters[second];\r\n}\r\n\r\n/**\r\n * Render seat grid or arc inside a zone\r\n */\r\nfunction renderSeats(element, scale) {\r\n    const { seatConfig, width, height, fill } = element;\r\n    if (!seatConfig) return null;\r\n\r\n    const { rowCount, colCount, seatNaming, showLabels, curvature = 0, categoryId } = seatConfig;\r\n    const seats = [];\r\n\r\n    // Derive category color\r\n    const categories = useSeatEngine.getState().categories;\r\n    const category = categories.find(c => c.id === categoryId);\r\n    const seatColor = category ? category.color : (fill || SEAT_FILL_DEFAULT);\r\n\r\n    // LOD: Skip rendering seats if zoomed out\r\n    if (scale < LOD_THRESHOLD) return null;\r\n\r\n    if (!rowCount || rowCount <= 0 || !colCount || colCount <= 0) return null;\r\n\r\n    const labelSpace = showLabels ? LABEL_WIDTH : 0;\r\n\r\n    // --- CURVED LOGIC ---\r\n    if (curvature > 0) {\r\n        // We Use Radian Math for Arcs\r\n        // centerX is middle of width, centerY is far above depending on curvature\r\n        const arcWidth = width - labelSpace;\r\n        const centerX = labelSpace + arcWidth / 2;\r\n\r\n        // Radius based on curvature (Higher curvature = Smaller radius = Deeper curve)\r\n        // 100% curvature = semicircleish. 0% = straight.\r\n        const baseRadius = (arcWidth * 100) / curvature;\r\n        const centerY = -baseRadius + height / 2;\r\n\r\n        const totalAngle = (arcWidth / baseRadius) * (180 / Math.PI);\r\n        const startAngle = -totalAngle / 2;\r\n\r\n        for (let row = 0; row < rowCount; row++) {\r\n            const currentRadius = baseRadius + row * (height / rowCount);\r\n            const step = totalAngle / Math.max(1, colCount - 1);\r\n\r\n            for (let col = 0; col < colCount; col++) {\r\n                const angle = startAngle + (col * step);\r\n                const pos = calculateArcPosition(centerX, centerY, currentRadius, angle);\r\n\r\n                seats.push(\r\n                    <Circle\r\n                        key={`seat-${row}-${col}`}\r\n                        x={pos.x}\r\n                        y={pos.y}\r\n                        radius={Math.min(10, 100 / colCount)}\r\n                        fill={seatColor}\r\n                        listening={false}\r\n                    />\r\n                );\r\n            }\r\n        }\r\n        return seats;\r\n    }\r\n\r\n    // --- STANDARD GRID LOGIC ---\r\n    const availableWidth = width - ZONE_PADDING * 2 - labelSpace;\r\n    const availableHeight = height - ZONE_PADDING * 2 - TITLE_HEIGHT;\r\n\r\n    if (availableWidth <= 0 || availableHeight <= 0) return null;\r\n\r\n    const cellWidth = availableWidth / colCount;\r\n    const cellHeight = availableHeight / rowCount;\r\n    const seatRadius = Math.max(3, Math.min(cellWidth, cellHeight) / 3);\r\n\r\n    for (let row = 0; row < rowCount; row++) {\r\n        const y = ZONE_PADDING + TITLE_HEIGHT + cellHeight / 2 + row * cellHeight;\r\n        if (showLabels) {\r\n            seats.push(\r\n                <Text\r\n                    key={`label-${row}`}\r\n                    x={ZONE_PADDING} y={y - 6}\r\n                    text={getRowLabel(row, seatNaming)}\r\n                    fontSize={10} fontStyle=\"bold\"\r\n                    fill={fill || \"#D4AF37\"} width={LABEL_WIDTH} align=\"center\"\r\n                    listening={false}\r\n                />\r\n            );\r\n        }\r\n        for (let col = 0; col < colCount; col++) {\r\n            const x = ZONE_PADDING + labelSpace + cellWidth / 2 + col * cellWidth;\r\n            seats.push(\r\n                <Circle key={`seat-${row}-${col}`} x={x} y={y} radius={seatRadius} fill={seatColor} listening={false} />\r\n            );\r\n        }\r\n    }\r\n    return seats;\r\n}\r\n\r\n/**\r\n * Universal Multi-Element Transformer\r\n */\r\nfunction MultiTransformer({ selectedIds }) {\r\n    const transformerRef = useRef(null);\r\n\r\n    useEffect(() => {\r\n        if (transformerRef.current) {\r\n            const stage = transformerRef.current.getStage();\r\n            const nodes = selectedIds.map(id => stage.findOne(node => node.name() === id || node.id() === id)).filter(Boolean);\r\n\r\n            // For Konva Groups, we often use name or custom attr to find them\r\n            // In our elements, we should add 'id' attribute to the Group\r\n            const elementNodes = stage.find('.element-group').filter(node => selectedIds.includes(node.id()));\r\n\r\n            transformerRef.current.nodes(elementNodes);\r\n            transformerRef.current.getLayer().batchDraw();\r\n        }\r\n    }, [selectedIds]);\r\n\r\n    if (selectedIds.length === 0) return null;\r\n\r\n    return (\r\n        <Transformer\r\n            ref={transformerRef}\r\n            rotateEnabled={true}\r\n            anchorSize={8}\r\n            anchorCornerRadius={2}\r\n            borderStroke=\"#D4AF37\"\r\n            anchorStroke=\"#D4AF37\"\r\n            rotateAnchorOffset={25}\r\n            boundBoxFunc={(oldBox, newBox) => {\r\n                // Minimum size\r\n                if (Math.abs(newBox.width) < 5 || Math.abs(newBox.height) < 5) {\r\n                    return oldBox;\r\n                }\r\n                return newBox;\r\n            }}\r\n        />\r\n    );\r\n}\r\n\r\n// Visual Asset Element\r\nfunction AssetElement({ element, isSelected, onSelect, onChange }) {\r\n    const shapeRef = useRef(null);\r\n\r\n    // We use assetType to render specific graphics\r\n    const renderAssetGraphic = () => {\r\n        const { assetConfig, width, height } = element;\r\n        // Prioritize element.fill (user's manual color choice) over default asset color\r\n        const color = element.fill || assetConfig?.color || \"#555\";\r\n\r\n        // Table specific rendering\r\n        if (assetConfig?.type === 'TABLE' || element.assetType === 'TABLE') {\r\n            const capacity = element.seatConfig?.capacity || assetConfig?.defaultCapacity || 6;\r\n            // Prioritize element.fill (user's manual color choice) over default asset color\r\n            const tableColor = element.fill || assetConfig?.color || \"#78350f\";\r\n            const chairs = [];\r\n            const radius = Math.min(width, height) / 2;\r\n            const chairRadius = radius / 4;\r\n\r\n            for (let i = 0; i < capacity; i++) {\r\n                const angle = (i / capacity) * 2 * Math.PI;\r\n                const x = width / 2 + Math.cos(angle) * (radius + chairRadius / 2);\r\n                const y = height / 2 + Math.sin(angle) * (radius + chairRadius / 2);\r\n                chairs.push(\r\n                    <Circle\r\n                        key={`chair-${i}`}\r\n                        x={x} y={y}\r\n                        radius={chairRadius}\r\n                        fill=\"#3f3f46\" // Zinc-700\r\n                        stroke={tableColor}\r\n                        strokeWidth={1}\r\n                        listening={false}\r\n                    />\r\n                );\r\n            }\r\n\r\n            return (\r\n                <Group>\r\n                    {/* Shadow for depth */}\r\n                    <Circle\r\n                        x={width / 2 + 2} y={height / 2 + 2}\r\n                        radius={radius}\r\n                        fill=\"black\"\r\n                        opacity={0.2}\r\n                        listening={false}\r\n                    />\r\n                    {/* Main Table */}\r\n                    <Circle\r\n                        x={width / 2} y={height / 2}\r\n                        radius={radius}\r\n                        fill={tableColor}\r\n                        stroke=\"#451a03\"\r\n                        strokeWidth={2}\r\n                        shadowBlur={5}\r\n                        shadowOpacity={0.5}\r\n                    />\r\n                    {/* Inner detail (Wood ring) */}\r\n                    <Circle\r\n                        x={width / 2} y={height / 2}\r\n                        radius={radius * 0.85}\r\n                        stroke=\"#451a03\"\r\n                        strokeWidth={1}\r\n                        opacity={0.3}\r\n                        listening={false}\r\n                    />\r\n                    {/* Center point */}\r\n                    <Circle\r\n                        x={width / 2} y={height / 2}\r\n                        radius={2}\r\n                        fill=\"#451a03\"\r\n                        opacity={0.5}\r\n                        listening={false}\r\n                    />\r\n                    {/* Chairs */}\r\n                    {chairs}\r\n                    {/* Capacity label */}\r\n                    <Text\r\n                        text={`${capacity}`}\r\n                        width={width} height={height}\r\n                        align=\"center\" verticalAlign=\"middle\"\r\n                        fill=\"white\" fontStyle=\"bold\" fontSize={radius / 2}\r\n                        opacity={0.9}\r\n                        listening={false}\r\n                    />\r\n                </Group>\r\n            );\r\n        }\r\n\r\n        return (\r\n            <Group>\r\n                <Rect\r\n                    width={width}\r\n                    height={height}\r\n                    fill={`${color}40`} // Low opacity fill\r\n                    stroke={color}\r\n                    strokeWidth={2}\r\n                    cornerRadius={4}\r\n                    dash={element.type === \"PILLAR\" ? undefined : [5, 2]}\r\n                />\r\n\r\n                {/* Diagonal crosses for Stacks/Tech */}\r\n                {(assetConfig?.type === \"STAGE\" || assetConfig?.type === \"CONSOLE\") && (\r\n                    <>\r\n                        <Line points={[0, 0, width, height]} stroke={color} strokeWidth={1} opacity={0.3} />\r\n                        <Line points={[width, 0, 0, height]} stroke={color} strokeWidth={1} opacity={0.3} />\r\n                    </>\r\n                )}\r\n\r\n                {/* Text Label */}\r\n                <Text\r\n                    text={element.name || assetConfig?.label || \"ASSET\"}\r\n                    width={width}\r\n                    height={height}\r\n                    align=\"center\"\r\n                    verticalAlign=\"middle\"\r\n                    fill=\"#fff\"\r\n                    fontStyle=\"bold\"\r\n                    fontSize={Math.max(10, Math.min(width, height) / 5)}\r\n                    padding={5}\r\n                />\r\n            </Group>\r\n        );\r\n    };\r\n\r\n    // Removed individual transformer logic in favor of MultiTransformer\r\n\r\n    return (\r\n        <>\r\n            <Group\r\n                id={element.id}\r\n                name=\"element-group\"\r\n                ref={shapeRef}\r\n                x={element.x} y={element.y}\r\n                width={element.width} height={element.height}\r\n                rotation={element.rotation || 0}\r\n                draggable\r\n                onClick={onSelect} onTap={onSelect}\r\n                onDragStart={(e) => {\r\n                    // Seamless drag: if not selected, select it first\r\n                    if (!isSelected) {\r\n                        useSeatEngine.getState().setSelectedIds([element.id]);\r\n                    }\r\n                    // Store initial positions for all selected elements\r\n                    const stage = e.target.getStage();\r\n                    const currentSelectedIds = useSeatEngine.getState().selectedIds;\r\n                    const allElements = useSeatEngine.getState().elements;\r\n\r\n                    // Include the current element if it wasn't selected before\r\n                    const targetIds = currentSelectedIds.includes(element.id)\r\n                        ? currentSelectedIds\r\n                        : [element.id];\r\n\r\n                    stage._draggedNodes = allElements\r\n                        .filter(el => targetIds.includes(el.id))\r\n                        .map(el => ({ id: el.id, x: el.x, y: el.y }));\r\n                    stage._dragStartPos = { x: e.target.x(), y: e.target.y() };\r\n                }}\r\n                onDragMove={(e) => {\r\n                    const stage = e.target.getStage();\r\n                    if (!stage._dragStartPos) return;\r\n\r\n                    const dx = e.target.x() - stage._dragStartPos.x;\r\n                    const dy = e.target.y() - stage._dragStartPos.y;\r\n\r\n                    // Visual update for other selected elements\r\n                    stage.find('.element-group').forEach(node => {\r\n                        if (node === e.target) return;\r\n                        const stored = stage._draggedNodes?.find(d => d.id === node.id());\r\n                        if (stored) {\r\n                            node.position({ x: stored.x + dx, y: stored.y + dy });\r\n                        }\r\n                    });\r\n                }}\r\n                onDragEnd={(e) => {\r\n                    const stage = e.target.getStage();\r\n                    if (!stage._dragStartPos) {\r\n                        onChange({ x: e.target.x(), y: e.target.y() });\r\n                        return;\r\n                    }\r\n\r\n                    const dx = e.target.x() - stage._dragStartPos.x;\r\n                    const dy = e.target.y() - stage._dragStartPos.y;\r\n\r\n                    // Update all dragged elements in store\r\n                    stage._draggedNodes?.forEach(d => {\r\n                        useSeatEngine.getState().updateElement(d.id, { x: d.x + dx, y: d.y + dy });\r\n                    });\r\n                    delete stage._draggedNodes;\r\n                    delete stage._dragStartPos;\r\n                }}\r\n                onTransformEnd={() => {\r\n                    const node = shapeRef.current;\r\n                    onChange({\r\n                        x: node.x(), y: node.y(),\r\n                        width: Math.max(20, node.width() * node.scaleX()),\r\n                        height: Math.max(20, node.height() * node.scaleY()),\r\n                        rotation: node.rotation()\r\n                    });\r\n                    node.scaleX(1); node.scaleY(1);\r\n                }}\r\n            >\r\n                {renderAssetGraphic()}\r\n            </Group>\r\n        </>\r\n    );\r\n}\r\n\r\n// Zone component with LOD\r\nfunction ZoneElement({ element, isSelected, onSelect, onChange, scale }) {\r\n    const groupRef = useRef(null);\r\n\r\n    // Removed individual transformer logic\r\n\r\n    const categories = useSeatEngine.getState().categories;\r\n    const category = categories.find(c => c.id === element.seatConfig?.categoryId);\r\n    const fillColor = category ? category.color : (element.fill || ZONE_FILL_DEFAULT);\r\n    const isLowDetail = scale < LOD_THRESHOLD;\r\n\r\n    return (\r\n        <>\r\n            <Group\r\n                id={element.id}\r\n                name=\"element-group\"\r\n                ref={groupRef}\r\n                x={element.x} y={element.y}\r\n                width={element.width} height={element.height}\r\n                rotation={element.rotation || 0}\r\n                draggable\r\n                onClick={onSelect} onTap={onSelect}\r\n                onDragStart={(e) => {\r\n                    // Seamless drag: if not selected, select it first\r\n                    if (!isSelected) {\r\n                        useSeatEngine.getState().setSelectedIds([element.id]);\r\n                    }\r\n                    const stage = e.target.getStage();\r\n                    const currentSelectedIds = useSeatEngine.getState().selectedIds;\r\n                    const allElements = useSeatEngine.getState().elements;\r\n                    const targetIds = currentSelectedIds.includes(element.id)\r\n                        ? currentSelectedIds\r\n                        : [element.id];\r\n\r\n                    stage._draggedNodes = allElements\r\n                        .filter(el => targetIds.includes(el.id))\r\n                        .map(el => ({ id: el.id, x: el.x, y: el.y }));\r\n                    stage._dragStartPos = { x: e.target.x(), y: e.target.y() };\r\n                }}\r\n                onDragMove={(e) => {\r\n                    const stage = e.target.getStage();\r\n                    if (!stage._dragStartPos) return;\r\n                    const dx = e.target.x() - stage._dragStartPos.x;\r\n                    const dy = e.target.y() - stage._dragStartPos.y;\r\n                    stage.find('.element-group').forEach(node => {\r\n                        if (node === e.target) return;\r\n                        const stored = stage._draggedNodes?.find(d => d.id === node.id());\r\n                        if (stored) node.position({ x: stored.x + dx, y: stored.y + dy });\r\n                    });\r\n                }}\r\n                onDragEnd={(e) => {\r\n                    const stage = e.target.getStage();\r\n                    if (!stage._dragStartPos) {\r\n                        onChange({ x: e.target.x(), y: e.target.y() });\r\n                        return;\r\n                    }\r\n                    const dx = e.target.x() - stage._dragStartPos.x;\r\n                    const dy = e.target.y() - stage._dragStartPos.y;\r\n                    stage._draggedNodes?.forEach(d => {\r\n                        useSeatEngine.getState().updateElement(d.id, { x: d.x + dx, y: d.y + dy });\r\n                    });\r\n                    delete stage._draggedNodes;\r\n                    delete stage._dragStartPos;\r\n                }}\r\n                onTransformEnd={() => {\r\n                    const node = groupRef.current;\r\n                    onChange({\r\n                        x: node.x(), y: node.y(),\r\n                        width: Math.max(20, node.width() * node.scaleX()),\r\n                        height: Math.max(20, node.height() * node.scaleY()),\r\n                        rotation: node.rotation()\r\n                    });\r\n                    node.scaleX(1); node.scaleY(1);\r\n                }}\r\n            >\r\n                <Rect\r\n                    width={element.width} height={element.height}\r\n                    fill={fillColor}\r\n                    opacity={isLowDetail ? LOD_OPACITY : ZONE_OPACITY}\r\n                    cornerRadius={isLowDetail ? 4 : 8}\r\n                    stroke={isSelected ? \"#D4AF37\" : fillColor}\r\n                    strokeWidth={isSelected ? 3 : 1}\r\n                />\r\n\r\n                {isLowDetail && (\r\n                    <Text\r\n                        text={element.name?.toUpperCase() || \"ZONE\"}\r\n                        width={element.width} height={element.height}\r\n                        fontSize={Math.min(element.width, element.height) / 4}\r\n                        fontStyle=\"bold\" fill=\"white\" align=\"center\" verticalAlign=\"middle\" listening={false}\r\n                    />\r\n                )}\r\n\r\n                {!isLowDetail && (\r\n                    <>\r\n                        {element.name && (\r\n                            <Text x={0} y={5} width={element.width} text={element.name} fontSize={12} fontStyle=\"bold\" fill={isSelected ? \"#fff\" : fillColor} align=\"center\" listening={false} />\r\n                        )}\r\n                        {renderSeats(element, scale)}\r\n                    </>\r\n                )}\r\n            </Group>\r\n        </>\r\n    );\r\n}\r\n\r\n// Circle element\r\nfunction CircleElement({ element, isSelected, onSelect, onChange }) {\r\n    const shapeRef = useRef(null);\r\n    const fillColor = element.fill || ZONE_FILL_DEFAULT;\r\n    return (\r\n        <Group\r\n            id={element.id}\r\n            name=\"element-group\"\r\n            ref={shapeRef} x={element.x} y={element.y} draggable onClick={onSelect}\r\n            onDragStart={(e) => {\r\n                if (!isSelected) {\r\n                    useSeatEngine.getState().setSelectedIds([element.id]);\r\n                }\r\n                const stage = e.target.getStage();\r\n                const currentSelectedIds = useSeatEngine.getState().selectedIds;\r\n                const allElements = useSeatEngine.getState().elements;\r\n                const targetIds = currentSelectedIds.includes(element.id)\r\n                    ? currentSelectedIds\r\n                    : [element.id];\r\n                stage._draggedNodes = allElements\r\n                    .filter(el => targetIds.includes(el.id))\r\n                    .map(el => ({ id: el.id, x: el.x, y: el.y }));\r\n                stage._dragStartPos = { x: e.target.x(), y: e.target.y() };\r\n            }}\r\n            onDragMove={(e) => {\r\n                const stage = e.target.getStage();\r\n                if (!stage._dragStartPos) return;\r\n                const dx = e.target.x() - stage._dragStartPos.x;\r\n                const dy = e.target.y() - stage._dragStartPos.y;\r\n                stage.find('.element-group').forEach(node => {\r\n                    if (node === e.target) return;\r\n                    const stored = stage._draggedNodes?.find(d => d.id === node.id());\r\n                    if (stored) node.position({ x: stored.x + dx, y: stored.y + dy });\r\n                });\r\n            }}\r\n            onDragEnd={(e) => {\r\n                const stage = e.target.getStage();\r\n                if (!stage._dragStartPos) {\r\n                    onChange({ x: e.target.x(), y: e.target.y() });\r\n                    return;\r\n                }\r\n                const dx = e.target.x() - stage._dragStartPos.x;\r\n                const dy = e.target.y() - stage._dragStartPos.y;\r\n                stage._draggedNodes?.forEach(d => {\r\n                    useSeatEngine.getState().updateElement(d.id, { x: d.x + dx, y: d.y + dy });\r\n                });\r\n                delete stage._draggedNodes;\r\n                delete stage._dragStartPos;\r\n            }}\r\n            onTransformEnd={() => {\r\n                const node = shapeRef.current;\r\n                const scale = Math.max(node.scaleX(), node.scaleY());\r\n                onChange({ x: node.x(), y: node.y(), width: element.width * scale, height: element.height * scale });\r\n                node.scaleX(1); node.scaleY(1);\r\n            }}\r\n        >\r\n            <Circle x={element.width / 2} y={element.height / 2} radius={element.width / 2} fill={fillColor} opacity={ZONE_OPACITY} stroke={isSelected ? \"#D4AF37\" : fillColor} strokeWidth={isSelected ? 2 : 1} />\r\n        </Group>\r\n    );\r\n}\r\n\r\nfunction PolygonElement({ element, isSelected, onSelect, onChange }) {\r\n    const shapeRef = useRef(null);\r\n    const fillColor = element.fill || ZONE_FILL_DEFAULT;\r\n    return (\r\n        <Group\r\n            id={element.id}\r\n            name=\"element-group\"\r\n            ref={shapeRef} x={element.x} y={element.y} draggable onClick={onSelect}\r\n            onDragStart={(e) => {\r\n                if (!isSelected) {\r\n                    useSeatEngine.getState().setSelectedIds([element.id]);\r\n                }\r\n                const stage = e.target.getStage();\r\n                const currentSelectedIds = useSeatEngine.getState().selectedIds;\r\n                const allElements = useSeatEngine.getState().elements;\r\n                const targetIds = currentSelectedIds.includes(element.id)\r\n                    ? currentSelectedIds\r\n                    : [element.id];\r\n                stage._draggedNodes = allElements\r\n                    .filter(el => targetIds.includes(el.id))\r\n                    .map(el => ({ id: el.id, x: el.x, y: el.y }));\r\n                stage._dragStartPos = { x: e.target.x(), y: e.target.y() };\r\n            }}\r\n            onDragMove={(e) => {\r\n                const stage = e.target.getStage();\r\n                if (!stage._dragStartPos) return;\r\n                const dx = e.target.x() - stage._dragStartPos.x;\r\n                const dy = e.target.y() - stage._dragStartPos.y;\r\n                stage.find('.element-group').forEach(node => {\r\n                    if (node === e.target) return;\r\n                    const stored = stage._draggedNodes?.find(d => d.id === node.id());\r\n                    if (stored) node.position({ x: stored.x + dx, y: stored.y + dy });\r\n                });\r\n            }}\r\n            onDragEnd={(e) => {\r\n                const stage = e.target.getStage();\r\n                if (!stage._dragStartPos) {\r\n                    onChange({ x: e.target.x(), y: e.target.y() });\r\n                    return;\r\n                }\r\n                const dx = e.target.x() - stage._dragStartPos.x;\r\n                const dy = e.target.y() - stage._dragStartPos.y;\r\n                stage._draggedNodes?.forEach(d => {\r\n                    useSeatEngine.getState().updateElement(d.id, { x: d.x + dx, y: d.y + dy });\r\n                });\r\n                delete stage._draggedNodes;\r\n                delete stage._dragStartPos;\r\n            }}\r\n        >\r\n            <Line points={element.points || []} closed fill={fillColor} opacity={ZONE_OPACITY} stroke={isSelected ? \"#D4AF37\" : fillColor} strokeWidth={2} />\r\n            {element.name && (\r\n                <Text\r\n                    text={element.name.toUpperCase()}\r\n                    x={element.points ? (Math.min(...element.points.filter((_, i) => i % 2 === 0)) + Math.max(...element.points.filter((_, i) => i % 2 === 0))) / 2 - 50 : 0}\r\n                    y={element.points ? (Math.min(...element.points.filter((_, i) => i % 2 === 1)) + Math.max(...element.points.filter((_, i) => i % 2 === 1))) / 2 - 10 : 0}\r\n                    width={100}\r\n                    align=\"center\"\r\n                    fontSize={14} fontStyle=\"bold\"\r\n                    fill={fillColor} opacity={0.6} letterSpacing={1}\r\n                    listening={false}\r\n                />\r\n            )}\r\n        </Group>\r\n    );\r\n}\r\n\r\n\r\nexport default function CanvasStage() {\r\n    const containerRef = useRef(null);\r\n    const stageRef = useRef(null);\r\n    const {\r\n        stageConfig, setStageSize, setStagePosition, tool, setTool, elements, addElement, updateElement,\r\n        selectedIds, setSelectedIds, toggleSelection, clearSelection, deleteSelectedElement, canvasSettings\r\n    } = useSeatEngine();\r\n\r\n    const [isDrawing, setIsDrawing] = useState(false);\r\n    const [isSelecting, setIsSelecting] = useState(false);\r\n    const [selectionBox, setSelectionBox] = useState({ x1: 0, y1: 0, x2: 0, y2: 0 });\r\n    const [drawStart, setDrawStart] = useState({ x: 0, y: 0 });\r\n    const [newElement, setNewElement] = useState(null);\r\n    const [polyPoints, setPolyPoints] = useState([]);\r\n    const [mousePos, setMousePos] = useState({ x: 0, y: 0 });\r\n\r\n    useEffect(() => {\r\n        const updateSize = () => {\r\n            if (!containerRef.current) return;\r\n            const { width, height } = containerRef.current.getBoundingClientRect();\r\n            setStageSize(width, height);\r\n        };\r\n        const resizeObserver = new ResizeObserver(updateSize);\r\n        if (containerRef.current) resizeObserver.observe(containerRef.current);\r\n        updateSize();\r\n        return () => resizeObserver.disconnect();\r\n    }, [setStageSize]);\r\n\r\n    // Integrated Keyboard Shortcuts\r\n    useSeatHotkeys();\r\n\r\n    const getRelativePos = () => {\r\n        const stage = stageRef.current;\r\n        if (!stage) return null;\r\n        const pointer = stage.getPointerPosition();\r\n        if (!pointer) return null;\r\n        return { x: (pointer.x - stage.x()) / stage.scaleX(), y: (pointer.y - stage.y()) / stage.scaleY() };\r\n    };\r\n\r\n    const handleWheel = useCallback((e) => {\r\n        e.evt.preventDefault();\r\n        const stage = stageRef.current;\r\n        const oldScale = stageConfig.scale;\r\n        const pointer = stage.getPointerPosition();\r\n        const mousePointTo = { x: (pointer.x - stageConfig.x) / oldScale, y: (pointer.y - stageConfig.y) / oldScale };\r\n        const newScale = Math.max(MIN_SCALE, Math.min(MAX_SCALE, oldScale * (e.evt.deltaY > 0 ? 1 / SCALE_FACTOR : SCALE_FACTOR)));\r\n        setStagePosition(pointer.x - mousePointTo.x * newScale, pointer.y - mousePointTo.y * newScale, newScale);\r\n    }, [stageConfig, setStagePosition]);\r\n\r\n    const handleMouseDown = (e) => {\r\n        if (tool === TOOL_TYPES.SELECT) {\r\n            if (e.target === e.target.getStage()) {\r\n                clearSelection();\r\n                // Start selection box\r\n                const pos = getRelativePos();\r\n                if (pos) {\r\n                    setIsSelecting(true);\r\n                    setSelectionBox({ x1: pos.x, y1: pos.y, x2: pos.x, y2: pos.y });\r\n                }\r\n            }\r\n            return;\r\n        }\r\n        if (tool === TOOL_TYPES.POLYGON) return;\r\n        const pos = getRelativePos();\r\n        if (!pos) return;\r\n        setIsDrawing(true);\r\n        setDrawStart(pos);\r\n\r\n        // Handle explicit asset tools\r\n        const isAssetTool = tool === \"STAGE\" || tool === \"EXIT\";\r\n        const finalToolType = isAssetTool ? TOOL_TYPES.IMAGE : tool;\r\n        const assetType = isAssetTool ? tool : null;\r\n\r\n        setNewElement({\r\n            type: finalToolType,\r\n            x: pos.x, y: pos.y,\r\n            width: 0, height: 0,\r\n            fill: ZONE_FILL_DEFAULT,\r\n            name: tool === TOOL_TYPES.RECTANGLE ? \"New Section\" : (isAssetTool ? tool : \"Asset\"),\r\n            assetType\r\n        });\r\n    };\r\n\r\n    const handleMouseMove = () => {\r\n        const pos = getRelativePos();\r\n        if (!pos) return;\r\n        setMousePos(pos);\r\n\r\n        if (isSelecting) {\r\n            setSelectionBox(prev => ({ ...prev, x2: pos.x, y2: pos.y }));\r\n            return;\r\n        }\r\n\r\n        if (!isDrawing || !newElement || tool === TOOL_TYPES.POLYGON) return;\r\n\r\n        const width = pos.x - drawStart.x;\r\n        const height = pos.y - drawStart.y;\r\n\r\n        // Asset types usually maintain aspect ratio or have minimum size for preview\r\n        const absWidth = Math.max(isDrawing && newElement.type === TOOL_TYPES.IMAGE ? 50 : 0, Math.abs(width));\r\n        const absHeight = Math.max(isDrawing && newElement.type === TOOL_TYPES.IMAGE ? 30 : 0, Math.abs(height));\r\n\r\n        setNewElement(prev => ({\r\n            ...prev,\r\n            width: absWidth,\r\n            height: absHeight,\r\n            x: width < 0 ? pos.x : drawStart.x,\r\n            y: height < 0 ? pos.y : drawStart.y\r\n        }));\r\n    };\r\n\r\n    const handleMouseUp = () => {\r\n        if (isSelecting) {\r\n            setIsSelecting(false);\r\n            // Find intersect elements\r\n            const x = Math.min(selectionBox.x1, selectionBox.x2);\r\n            const y = Math.min(selectionBox.y1, selectionBox.y2);\r\n            const w = Math.abs(selectionBox.x1 - selectionBox.x2);\r\n            const h = Math.abs(selectionBox.y1 - selectionBox.y2);\r\n\r\n            if (w > 5 && h > 5) {\r\n                const intersectIds = elements.filter(el => {\r\n                    // Check if element's bounding box intersects with selection box\r\n                    // Element box: el.x, el.y, el.width, el.height\r\n                    const elX = el.x;\r\n                    const elY = el.y;\r\n                    const elR = el.x + el.width;\r\n                    const elB = el.y + el.height;\r\n\r\n                    const selX = x;\r\n                    const selY = y;\r\n                    const selR = x + w;\r\n                    const selB = y + h;\r\n\r\n                    return !(selR < elX || selX > elR || selB < elY || selY > elB);\r\n                }).map(el => el.id);\r\n\r\n                if (intersectIds.length > 0) {\r\n                    setSelectedIds(intersectIds);\r\n                }\r\n            }\r\n            return;\r\n        }\r\n\r\n        if (!isDrawing || tool === TOOL_TYPES.POLYGON) return;\r\n        if (newElement && (newElement.width > 20 || tool === TOOL_TYPES.IMAGE)) {\r\n            addElement(newElement);\r\n        }\r\n        setIsDrawing(false); setNewElement(null);\r\n    };\r\n\r\n    const handleStageClick = () => {\r\n        if (tool !== TOOL_TYPES.POLYGON) return;\r\n        const pos = getRelativePos();\r\n        if (!pos) return;\r\n        if (polyPoints.length >= 6) {\r\n            const dist = Math.sqrt(Math.pow(pos.x - polyPoints[0], 2) + Math.pow(pos.y - polyPoints[1], 2));\r\n            if (dist < SNAP_RADIUS) {\r\n                addElement({ type: TOOL_TYPES.POLYGON, name: \"Standing Area\", points: polyPoints, fill: \"#ef4444\", x: 0, y: 0, width: 10, height: 10 });\r\n                setPolyPoints([]); return;\r\n            }\r\n        }\r\n        setPolyPoints(prev => [...prev, pos.x, pos.y]);\r\n    };\r\n\r\n    const handleDrop = (e) => {\r\n        e.preventDefault();\r\n\r\n        // Try to parse dropped asset data\r\n        const assetJson = e.dataTransfer.getData(\"asset\");\r\n        if (!assetJson) return;\r\n\r\n        try {\r\n            const asset = JSON.parse(assetJson);\r\n            const stage = stageRef.current;\r\n            stage.setPointersPositions(e);\r\n\r\n            // Get pointer position relative to stage (account for pan/zoom)\r\n            const transform = stage.getAbsoluteTransform().copy();\r\n            transform.invert();\r\n            const pos = transform.point(stage.getPointerPosition());\r\n\r\n            addElement({\r\n                type: TOOL_TYPES.ASSET,\r\n                x: pos.x,\r\n                y: pos.y,\r\n                width: asset.width,\r\n                height: asset.height,\r\n                rotation: 0,\r\n                name: asset.label,\r\n                assetConfig: asset // Store full asset metadata\r\n            });\r\n\r\n            // Switch to Select tool to avoid confusion\r\n            if (setTool) setTool(TOOL_TYPES.SELECT);\r\n            else useSeatEngine.getState().setTool(TOOL_TYPES.SELECT);\r\n        } catch (err) {\r\n            console.error(\"Failed to drop asset:\", err);\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div\r\n            ref={containerRef}\r\n            className=\"relative w-full h-full bg-zinc-950 overflow-hidden\"\r\n            onDragOver={(e) => e.preventDefault()}\r\n            onDrop={handleDrop}\r\n        >\r\n            {/* Grid */}\r\n            <div style={{\r\n                position: \"absolute\", inset: 0,\r\n                backgroundImage: `radial-gradient(circle, rgba(212, 175, 55, 0.15) 1px, transparent 1px)`,\r\n                backgroundSize: `${20 * stageConfig.scale}px ${20 * stageConfig.scale}px`,\r\n                backgroundPosition: `${stageConfig.x}px ${stageConfig.y}px`,\r\n                pointerEvents: \"none\"\r\n            }} />\r\n\r\n            <Stage\r\n                ref={stageRef}\r\n                width={stageConfig.width} height={stageConfig.height}\r\n                x={stageConfig.x} y={stageConfig.y}\r\n                scaleX={stageConfig.scale} scaleY={stageConfig.scale}\r\n                onWheel={handleWheel}\r\n                onMouseDown={handleMouseDown}\r\n                onMouseMove={handleMouseMove}\r\n                onMouseUp={handleMouseUp}\r\n                onClick={handleStageClick}\r\n                draggable={tool === TOOL_TYPES.SELECT && selectedIds.length === 0}\r\n                onDragEnd={(e) => setStagePosition(e.target.x(), e.target.y(), stageConfig.scale)}\r\n                style={{ cursor: tool === TOOL_TYPES.SELECT ? \"default\" : \"crosshair\" }}\r\n            >\r\n                <Layer>\r\n                    {elements.map(el => {\r\n                        const isSelected = selectedIds.includes(el.id);\r\n                        const handleSelect = (e) => {\r\n                            // If shift is pressed, toggle selection\r\n                            if (e.evt.shiftKey) {\r\n                                toggleSelection(el.id);\r\n                            } else {\r\n                                // Otherwise, single selection (unless already part of a multi-selection)\r\n                                if (!isSelected) {\r\n                                    setSelectedIds([el.id]);\r\n                                }\r\n                            }\r\n                        };\r\n\r\n                        if (el.type === TOOL_TYPES.RECTANGLE || el.type === TOOL_TYPES.CURVE)\r\n                            return <ZoneElement key={el.id} element={el} isSelected={isSelected} onSelect={handleSelect} onChange={u => updateElement(el.id, u)} scale={stageConfig.scale} />;\r\n                        if (el.type === TOOL_TYPES.CIRCLE)\r\n                            return <CircleElement key={el.id} element={el} isSelected={isSelected} onSelect={handleSelect} onChange={u => updateElement(el.id, u)} />;\r\n                        if (el.type === TOOL_TYPES.POLYGON)\r\n                            return <PolygonElement key={el.id} element={el} isSelected={isSelected} onSelect={handleSelect} onChange={u => updateElement(el.id, u)} />;\r\n                        if (el.type === TOOL_TYPES.IMAGE || el.type === TOOL_TYPES.ASSET)\r\n                            return <AssetElement key={el.id} element={el} isSelected={isSelected} onSelect={handleSelect} onChange={u => updateElement(el.id, u)} />;\r\n                        return null;\r\n                    })}\r\n\r\n                    {/* Multi-Select Transformer */}\r\n                    <MultiTransformer selectedIds={selectedIds} />\r\n\r\n                    {/* Selection Box */}\r\n                    {isSelecting && (\r\n                        <Rect\r\n                            x={Math.min(selectionBox.x1, selectionBox.x2)}\r\n                            y={Math.min(selectionBox.y1, selectionBox.y2)}\r\n                            width={Math.abs(selectionBox.x1 - selectionBox.x2)}\r\n                            height={Math.abs(selectionBox.y1 - selectionBox.y2)}\r\n                            fill=\"rgba(212, 175, 55, 0.1)\"\r\n                            stroke=\"#D4AF37\"\r\n                            strokeWidth={1}\r\n                            dash={[4, 2]}\r\n                        />\r\n                    )}\r\n\r\n                    {isDrawing && newElement && (\r\n                        <Rect x={newElement.x} y={newElement.y} width={newElement.width} height={newElement.height} fill={ZONE_FILL_DEFAULT} opacity={0.3} stroke=\"#D4AF37\" strokeWidth={1} dash={[5, 5]} />\r\n                    )}\r\n\r\n                    {tool === TOOL_TYPES.POLYGON && polyPoints.length > 0 && (\r\n                        <>\r\n                            <Line points={polyPoints} stroke=\"#D4AF37\" strokeWidth={2} />\r\n                            <Line points={[polyPoints[polyPoints.length - 2], polyPoints[polyPoints.length - 1], mousePos.x, mousePos.y]} stroke=\"#D4AF37\" strokeWidth={1} dash={[5, 2]} />\r\n                            <Circle x={polyPoints[0]} y={polyPoints[1]} radius={5} fill=\"#D4AF37\" />\r\n                        </>\r\n                    )}\r\n                </Layer>\r\n            </Stage>\r\n            <div className=\"absolute bottom-4 left-4 text-[10px] text-zinc-600 font-mono\">SCALE: {Math.round(stageConfig.scale * 100)}% | LOD: {stageConfig.scale < LOD_THRESHOLD ? \"LOW\" : \"HIGH\"}</div>\r\n        </div>\r\n    );\r\n}\r\n"],"names":[],"mappings":"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"}}]
}